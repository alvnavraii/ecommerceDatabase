-- Creamos la nueva tabla
CREATE TABLE ADDRESSES_NEW (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    USER_ID NUMBER,
    ADDRESS CLOB NOT NULL,
    MUNICIPALITY_ID NUMBER NOT NULL,
    POSTAL_CODE VARCHAR2(5) NOT NULL,
    IS_DEFAULT NUMBER(1) NOT NULL,
    IS_ACTIVE NUMBER(1) DEFAULT 1 NOT NULL,
    CREATED_AT TIMESTAMP(6) DEFAULT CURRENT_TIMESTAMP NOT NULL,
    UPDATED_AT TIMESTAMP(6) DEFAULT CURRENT_TIMESTAMP NOT NULL,
    CREATED_BY VARCHAR2(50) NOT NULL,
    UPDATED_BY VARCHAR2(50) NOT NULL,
    CONSTRAINT PK_ADDRESSES_NEW PRIMARY KEY (ID),
    CONSTRAINT FK_ADDRESSES_NEW_USER FOREIGN KEY (USER_ID) REFERENCES USERS(ID)
);


-- Eliminamos la tabla antigua y renombramos la nueva
DROP TABLE ADDRESSES;
ALTER TABLE ADDRESSES_NEW RENAME TO ADDRESSES;

COMMIT;
